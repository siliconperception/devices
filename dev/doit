#!/bin/bash

# STEP 1 : initialize with adamw
python pretrain.py --n_hidden 256 --n_enc 256 --n_dec 64 --context 14 --dataset tiny --shuffle --learning_rate 0.0001 --opt adamw --weight_decay 0.1 --beta2 0.9 --batch 200 --monitor 100 --generate 2000 --freeze --alt repl-tree-jumbo

# STEP 2 : fine tune using sgd
python pretrain.py --n_hidden 256 --n_enc 256 --n_dec 64 --context 14 --dataset tiny --shuffle --learning_rate 0.0001 --opt sgd --weight_decay 0.0 --momentum 0.0 --batch 200 --monitor 100 --generate 2000 --freeze --alt repl-tree-jumbo --load checkpoint.pt


python generate.py --vis --pretrained
python chart.py --head 10 --log log/log.2025.10.27-14.25.03
